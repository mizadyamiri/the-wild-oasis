import{u as C,n as F,_ as j,c as v,r as w,j as e,B as c,H as f}from"./index-438dd456.js";import{R as g}from"./Row-b6073b20.js";import{F as S}from"./FileInput-72be628f.js";import{F as U,I as m}from"./Form-b2b8dfd7.js";import{F as n}from"./FormRow-f69adc6e.js";import{u as y}from"./useMutation-5e0b73ac.js";import{u as q}from"./index.esm-f9283d01.js";function b(){const i=C(),{mutate:d,isLoading:u}=y({mutationFn:F,onSuccess:({user:s})=>{j.success("User account successfull updated"),i.setQueriesData(["user"],s)},onError:s=>{j.error(s.massage)}});return{updateUser:d,isUpdating:u}}function N(){const{user:{email:i,user_metadata:{fullName:d}}}=v(),{updateUser:u,isUpdating:s}=b(),[o,a]=w.useState(d),[p,t]=w.useState(null);function h(r){r.preventDefault(),o&&u({fullName:o,avatar:p},{onSuccess:()=>{t(null),r.target.reset()}})}function l(){a(d),t(null)}return e.jsxs(U,{onSubmit:h,children:[e.jsx(n,{label:"Email address",children:e.jsx(m,{value:i,disabled:!0})}),e.jsx(n,{label:"Full name",children:e.jsx(m,{type:"text",value:o,onChange:r=>a(r.target.value),id:"fullName",disabled:s})}),e.jsx(n,{label:"Avatar image",children:e.jsx(S,{id:"avatar",accept:"image/*",onChange:r=>t(r.target.files[0]),disabled:s})}),e.jsxs(n,{children:[e.jsx(c,{disabled:s,type:"reset",variation:"secondary",onClick:l,children:"Cancel"}),e.jsx(c,{disabled:s,children:"Update account"})]})]})}function E(){var l,r;const{register:i,handleSubmit:d,formState:u,getValues:s,reset:o}=q(),{errors:a}=u,{updateUser:p,isUpdating:t}=b();function h({password:x}){p({password:x},{onSuccess:o})}return e.jsxs(U,{onSubmit:d(h),children:[e.jsx(n,{label:"Password (min 8 characters)",error:(l=a==null?void 0:a.password)==null?void 0:l.message,children:e.jsx(m,{type:"password",id:"password",autoComplete:"current-password",disabled:t,...i("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e.jsx(n,{label:"Confirm password",error:(r=a==null?void 0:a.passwordConfirm)==null?void 0:r.message,children:e.jsx(m,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:t,...i("passwordConfirm",{required:"This field is required",validate:x=>s().password===x||"Passwords need to match"})})}),e.jsxs(n,{children:[e.jsx(c,{onClick:o,type:"reset",variation:"secondary",children:"Cancel"}),e.jsx(c,{disabled:t,children:"Update password"})]})]})}function B(){return e.jsxs(e.Fragment,{children:[e.jsx(f,{as:"h1",children:"Update your account"}),e.jsxs(g,{children:[e.jsx(f,{as:"h3",children:"Update user data"}),e.jsx(N,{})]}),e.jsxs(g,{children:[e.jsx(f,{as:"h3",children:"Update password"}),e.jsx(E,{})]})]})}export{B as default};
